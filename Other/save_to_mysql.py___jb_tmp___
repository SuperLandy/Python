#encoding:utf-8
import pymysql,datetime,logging
db = pymysql.connect(host='192.168.91.40',user='root',passwd='root',db='my_server')
cur =  db.cursor()
today = datetime.datetime.today().strftime('%m%d')
#复制并重置表格
print('create new table.......')
cur.execute('create table server_for_2018%s like server_for_20180706'%today) #copy
cur.execute('truncate server_for_2018%s'%today)
db.commit()

print('insert date to table....')
#插入每日数据
updat_sql = '''
insert into server_for_2018%s(hostname,ip,cpu,task,menory,disk)values
('mysql',        '120.78.86.254',   5,    136,   17.3,   '62-0-0-1-0-0-70'),

('portal',       '120.78.86.29',	    1,	  143,   6.75,	 '44-0-0-1-0-0'),

('qb充值',	       '47.100.90.52',	4,	147,   33,    '9-3-2-37'),

('svn',	          '120.78.87.162',	2,	97,    7,  '8-0-0-1-0-0-23-0'),

('测试机',	       '120.24.173.64',	1,	332,	66,	  '36-0-68'),

('充值吧',	      '43.243.130.43',	0.1,   481,  21.3,	  '9-0-1-53-4'),

('第三方组件10', '120.78.84.10',	     34,   124,	   25.9,	'10-0-0-1-0-0-0-0'),

('第三方组件147',	'120.78.86.147',	15,	  131,	   23.2,	'13-0-0-1-0-0-0'),

('后台服务器178',	'120.77.218.178', 54,	  112,	   6.8,  	'20-0-0-1-0-0-0'),

('后台服务器60',	'120.78.75.60',	0.1,	88,	   7.03,	 '31-0-0-1-0-0-0'),

('话费80',         '45.126.120.80',	0.1,   1071,	6.9,   '4-0-18-53-67'),

('话费81',	       '45.126.120.81',	0.1,   935,	   56.5,	  '2-64-31-57-48'),

('话费82',	        '45.126.120.82',	0.1,	1095,	5.5,	'2-1-17-53-61'),

('话费83',	       '45.126.120.83',	0.1,	901,	9.7,	   '4-1-6-57-62'),

('话费84',	      '45.126.120.84',	0.1,	617,	9,	'41-4-51-4-65-1'),

('话费85',	     '45.126.120.85',  	0.1	,   644,   63, 	'15-1-35-55-1-1'),

('流量充值',	 '47.100.95.135',	    8,	 165,	23.7,	   '10-1-8-63')
'''%today
cur.execute(updat_sql)
db.commit()
db.close()
print('ok')



